<!DOCTYPE html>
<html lang="uk" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–æ–≤–∏–Ω–Ω–∏–π –±–ª–æ–≥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        .wysiwyg-editor {
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }
        .wysiwyg-toolbar button {
            padding: 8px 12px;
            margin: 2px;
            border: 1px solid #000000;
            background: white;
            border-radius: 4px;
        }
        .wysiwyg-toolbar button:hover {
            background: #ffffff;
        }
        .news-image {
            max-width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .tag {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            background: #000000;
            color: white;
            border-radius: 12px;
            font-size: 12px;
        }
        .error-message {
            color: #dc2626;
            font-size: 14px;
            margin-top: 4px;
        }
        .success-message {
            color: #16a34a;
            font-size: 14px;
            margin-top: 4px;
        }
        .password-input-container {
            position: relative;
        }
        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            user-select: none;
            color: #666;
        }
        .password-toggle:hover {
            color: #000;
        }
        .remove-image-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #dc2626;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 14px;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#000000'
                    }
                }
            }
        }
    </script>
</head>
<body class="h-full bg-white text-black">
    <div id="app" class="min-h-full">
        <!-- Navigation -->
        <nav class="bg-white shadow-sm border-b border-black">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <h1 class="text-xl font-bold text-black">–ù–æ–≤–∏–Ω–Ω–∏–π –±–ª–æ–≥</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="showPage('home')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-white">–ì–æ–ª–æ–≤–Ω–∞</button>
                        <button onclick="showPage('about')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-white">–ü—Ä–æ –¥–æ–¥–∞—Ç–æ–∫</button>
                        <button id="loginBtn" onclick="showPage('login')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-white">–í—Ö—ñ–¥</button>
                        <button id="registerBtn" onclick="showPage('register')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-white">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
                        <button id="adminBtn" onclick="showPage('admin')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-white hidden">–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è</button>
                        <span id="userGreeting" class="text-black hidden"></span>
                        <button id="logoutBtn" onclick="logout()" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-red-600 hover:bg-white hidden">–í–∏—Ö—ñ–¥</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main content -->
        <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <!-- Home page -->
            <div id="homePage" class="page">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold mb-4 text-black">–û—Å—Ç–∞–Ω–Ω—ñ –Ω–æ–≤–∏–Ω–∏</h2>
                    
                    <!-- Tags filter -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2 text-black">–§—ñ–ª—å—Ç—Ä –∑–∞ —Ç–µ–≥–∞–º–∏:</label>
                        <div id="tagsFilter" class="flex flex-wrap gap-2">
                            <button onclick="filterByTag(null)" class="tag-filter-btn bg-white border border-black px-3 py-1 rounded text-sm active">–í—Å—ñ</button>
                        </div>
                    </div>
                </div>
                
                <div id="newsList" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                    <!-- News items will be rendered here -->
                </div>
            </div>

            <!-- News detail page -->
            <div id="newsDetailPage" class="page hidden">
                <button onclick="showPage('home')" class="mb-4 text-black hover:underline">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É</button>
                <div id="newsDetail"></div>
            </div>

            <!-- About page -->
            <div id="aboutPage" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-black">–ü—Ä–æ –¥–æ–¥–∞—Ç–æ–∫</h2>
                <div class="bg-white border border-black p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4 text-black">–§—É–Ω–∫—Ü—ñ—ó –¥–æ–¥–∞—Ç–∫—É:</h3>
                    <ul class="list-disc list-inside space-y-2 mb-6 text-black">
                        <li>–ü–µ—Ä–µ–≥–ª—è–¥ –Ω–æ–≤–∏–Ω –¥–ª—è –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤</li>
                        <li>–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–∏–Ω –∑–∞ —Ç–µ–≥–∞–º–∏</li>
                        <li>–ü–æ–≤–Ω–∏–π –ø–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–µ–π</li>
                        <li>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –∞–∫–∞—É–Ω—Ç–∏</li>
                        <li>–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É (–¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤)</li>
                        <li>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å</li>
                        <li>WYSIWYG —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É</li>
                        <li>–°–∏—Å—Ç–µ–º–∞ —Ç–µ–≥—ñ–≤</li>
                        <li>Email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è</li>
                        <li>–ù–µ–æ–±–º–µ–∂–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–æ–≤–∏–Ω</li>
                    </ul>
                    <h3 class="text-xl font-semibold mb-4 text-black">–†–æ–∑—Ä–æ–±–Ω–∏–∫:</h3>
                    <p class="text-black">–¶–µ–π –¥–æ–¥–∞—Ç–æ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–æ —è–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π –¥–ª—è –Ω–æ–≤–∏–Ω–Ω–æ–≥–æ –±–ª–æ–≥—É –∑ —Å–∏—Å—Ç–µ–º–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.</p>
                </div>
            </div>

            <!-- Register page -->
            <div id="registerPage" class="page hidden">
                <div class="max-w-md mx-auto bg-white border border-black p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-6 text-center text-black">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h2>
                    <form onsubmit="register(event)">
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–Ü–º'—è:</label>
                            <input type="text" id="registerName" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black" required>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">Email:</label>
                            <input type="email" id="registerEmail" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black" required>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–õ–æ–≥—ñ–Ω:</label>
                            <input type="text" id="registerUsername" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black" required minlength="3">
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–ü–∞—Ä–æ–ª—å:</label>
                            <div class="password-input-container">
                                <input type="password" id="registerPassword" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black pr-10" required minlength="6">
                                <span class="password-toggle" onclick="togglePassword('registerPassword', this)">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </span>
                            </div>
                            <div class="text-sm text-black mt-1">–ú—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤</div>
                        </div>
                        <div class="mb-6">
                            <label class="block text-sm font-medium mb-2 text-black">–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å:</label>
                            <div class="password-input-container">
                                <input type="password" id="registerPasswordConfirm" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black pr-10" required>
                                <span class="password-toggle" onclick="togglePassword('registerPasswordConfirm', this)">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </span>
                            </div>
                        </div>
                        <div id="registerMessage"></div>
                        <button type="submit" class="w-full bg-black text-white py-2 px-4 rounded-md hover:bg-black mb-4">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
                    </form>
                    <div class="text-center">
                        <span class="text-black">–í–∂–µ –º–∞—î—Ç–µ –∞–∫–∞—É–Ω—Ç? </span>
                        <button onclick="showPage('login')" class="text-black underline hover:no-underline">–£–≤—ñ–π—Ç–∏</button>
                    </div>
                </div>
            </div>

            <!-- Login page -->
            <div id="loginPage" class="page hidden">
                <div class="max-w-md mx-auto bg-white border border-black p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-6 text-center text-black">–í—Ö—ñ–¥ –¥–æ —Å–∏—Å—Ç–µ–º–∏</h2>
                    <form onsubmit="login(event)">
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–õ–æ–≥—ñ–Ω:</label>
                            <input type="text" id="loginUsername" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black" required>
                        </div>
                        <div class="mb-6">
                            <label class="block text-sm font-medium mb-2 text-black">–ü–∞—Ä–æ–ª—å:</label>
                            <div class="password-input-container">
                                <input type="password" id="loginPassword" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black pr-10" required>
                                <span class="password-toggle" onclick="togglePassword('loginPassword', this)">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </span>
                            </div>
                        </div>
                        <div id="loginMessage"></div>
                        <button type="submit" class="w-full bg-black text-white py-2 px-4 rounded-md hover:bg-black mb-4">–£–≤—ñ–π—Ç–∏</button>
                    </form>
                    <div class="text-center">
                        <span class="text-black">–ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç—É? </span>
                        <button onclick="showPage('register')" class="text-black underline hover:no-underline">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
                    </div>
                </div>
            </div>

            <!-- Admin page -->
            <div id="adminPage" class="page hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-black">–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è –Ω–æ–≤–∏–Ω</h2>
                    <button onclick="showAddForm()" class="bg-black text-white px-4 py-2 rounded-md hover:bg-black">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–Ω—É</button>
                </div>
                
                <div class="bg-white border border-black rounded-lg shadow overflow-hidden">
                    <table class="min-w-full">
                        <thead class="bg-white border-b border-black">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">–ù–∞–∑–≤–∞</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">–ê–≤—Ç–æ—Ä</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">–î–∞—Ç–∞</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">–î—ñ—ó</th>
                            </tr>
                        </thead>
                        <tbody id="adminNewsList" class="bg-white divide-y divide-black">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Add/Edit news form -->
            <div id="newsFormPage" class="page hidden">
                <div class="max-w-4xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="formTitle" class="text-3xl font-bold text-black">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–Ω—É</h2>
                        <button onclick="showPage('admin')" class="text-black hover:text-black">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    </div>
                    
                    <form onsubmit="saveNews(event)" class="bg-white border border-black p-6 rounded-lg shadow">
                        <input type="hidden" id="newsId">
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–ù–∞–∑–≤–∞:</label>
                            <input type="text" id="newsTitle" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black" required>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–ê–≤—Ç–æ—Ä:</label>
                            <input type="text" id="newsAuthor" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black" required>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è:</label>
                            <input type="file" id="newsImage" accept="image/*" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black">
                            <div id="currentImageContainer" class="mt-2 hidden relative inline-block">
                                <img id="currentImage" class="news-image" alt="–ü–æ—Ç–æ—á–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è">
                                <button type="button" class="remove-image-btn" onclick="removeCurrentImage()" title="–í–∏–¥–∞–ª–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è">√ó</button>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 text-black">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∫–æ–º—É):</label>
                            <input type="text" id="newsTags" placeholder="–ø–æ–ª—ñ—Ç–∏–∫–∞, –µ–∫–æ–Ω–æ–º—ñ–∫–∞, —Å–ø–æ—Ä—Ç" class="w-full px-3 py-2 text-base border border-black rounded-md bg-white text-black">
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-sm font-medium mb-2 text-black">–ó–º—ñ—Å—Ç:</label>
                            
                            <!-- WYSIWYG toolbar -->
                            <div class="wysiwyg-toolbar border border-black rounded-t-md p-2 bg-white">
                                <button type="button" onclick="formatText('bold')" title="–ñ–∏—Ä–Ω–∏–π"><strong>B</strong></button>
                                <button type="button" onclick="formatText('italic')" title="–ö—É—Ä—Å–∏–≤"><em>I</em></button>
                                <button type="button" onclick="formatText('underline')" title="–ü—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–∏–π"><u>U</u></button>
                                <button type="button" onclick="formatText('insertUnorderedList')" title="–°–ø–∏—Å–æ–∫">‚Ä¢</button>
                                <button type="button" onclick="formatText('formatBlock', 'h2')" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫">H</button>
                                <button type="button" onclick="formatText('createLink')" title="–ü–æ—Å–∏–ª–∞–Ω–Ω—è">üîó</button>
                            </div>
                            
                            <div id="newsContent" class="wysiwyg-editor w-full px-3 py-2 text-base border border-t-0 border-black rounded-b-md bg-white text-black" contenteditable="true" style="min-height: 200px;"></div>
                        </div>
                        
                        <div class="flex justify-end space-x-4">
                            <button type="button" onclick="showPage('admin')" class="px-4 py-2 border border-black rounded-md hover:bg-white">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                            <button type="submit" class="bg-black text-white px-4 py-2 rounded-md hover:bg-black">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Application state
        let currentUser = null;
        let currentPage = 'home';
        let currentFilter = null;
        let editingNewsId = null;
        
        // Users database (in memory for this demo)
        let users = [
            {
                id: 1,
                name: "–î–º–∏—Ç—Ä–æ –ë—É–π–Ω–æ–≤—Å—å–∫–∏–π",
                email: "dimabuynovskiy11@gmail.com",
                username: "dimabuinovskyi",
                password: "Qwerty0221",
                role: "admin"
            },
            {
                id: 2,
                name: "–û–ª–µ–∫—Å–∞–Ω–¥—Ä –ó–∞–∫—É—Å–∏–ª–æ",
                email: "sanyazakysulo@gmail.com",
                username: "sanyazakysulo",
                password: "Qwerty0221",
                role: "admin"
            }
        ];
        
        // Sample data
        let newsData = [
            {
                id: 1,
                title: "–í–∞–∂–ª–∏–≤—ñ –Ω–æ–≤–∏–Ω–∏ –µ–∫–æ–Ω–æ–º—ñ–∫–∏",
                author: "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
                date: new Date('2024-01-15'),
                content: "<h2>–ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ –∑–º—ñ–Ω–∏</h2><p>–°—å–æ–≥–æ–¥–Ω—ñ –≤—ñ–¥–±—É–ª–∏—Å—è –≤–∞–∂–ª–∏–≤—ñ –∑–º—ñ–Ω–∏ –≤ –µ–∫–æ–Ω–æ–º—ñ—á–Ω–æ–º—É —Å–µ–∫—Ç–æ—Ä—ñ. <strong>–ï–∫—Å–ø–µ—Ä—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑—É—é—Ç—å</strong> –ø–æ–∑–∏—Ç–∏–≤–Ω—ñ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—ó –Ω–∞ –Ω–∞–π–±–ª–∏–∂—á—ñ –º—ñ—Å—è—Ü—ñ.</p><ul><li>–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è –í–í–ü</li><li>–ó–Ω–∏–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–ª—è—Ü—ñ—ó</li><li>–°—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è –≤–∞–ª—é—Ç–∏</li></ul>",
                image: null,
                tags: ["–µ–∫–æ–Ω–æ–º—ñ–∫–∞", "–ø–æ–ª—ñ—Ç–∏–∫–∞"]
            },
            {
                id: 2,
                title: "–°–ø–æ—Ä—Ç–∏–≤–Ω—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è",
                author: "–ú–∞—Ä—ñ—è –ö–æ–≤–∞–ª–µ–Ω–∫–æ",
                date: new Date('2024-01-14'),
                content: "<h2>–ü–µ—Ä–µ–º–æ–≥–∞ –∫–æ–º–∞–Ω–¥–∏</h2><p>–ù–∞—à–∞ –Ω–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–¥–æ–±—É–ª–∞ <em>–≤–ø–µ–≤–Ω–µ–Ω—É –ø–µ—Ä–µ–º–æ–≥—É</em> —É –≤–∞–∂–ª–∏–≤–æ–º—É –º–∞—Ç—á—ñ. –¶–µ –ø–µ—Ä—à–∞ –ø–µ—Ä–µ–º–æ–≥–∞ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ —Ç—Ä–∏ –º—ñ—Å—è—Ü—ñ.</p><p>–¢—Ä–µ–Ω–µ—Ä –∫–æ–º–∞–Ω–¥–∏ –≤–∏—Å–ª–æ–≤–∏–≤ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —ñ –ø–æ–¥—è–∫—É–≤–∞–≤ –≤–±–æ–ª—ñ–≤–∞–ª—å–Ω–∏–∫–∞–º –∑–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫—É.</p>",
                image: null,
                tags: ["—Å–ø–æ—Ä—Ç", "—Ñ—É—Ç–±–æ–ª"]
            },
            {
                id: 3,
                title: "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω—ñ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó",
                author: "–û–ª–µ–∫—Å—ñ–π –°–∏–¥–æ—Ä–µ–Ω–∫–æ",
                date: new Date('2024-01-13'),
                content: "<h2>–ù–æ–≤—ñ—Ç–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó</h2><p>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è, —è–∫—ñ –º–æ–∂—É—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞—à—É –ø–æ–≤—Å—è–∫–¥–µ–Ω–Ω—ñ—Å—Ç—å. <strong>–Ü–Ω–Ω–æ–≤–∞—Ü—ñ—ó –≤–∫–ª—é—á–∞—é—Ç—å:</strong></p><ul><li>–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç</li><li>–†–æ–∑—É–º–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó</li><li>–ï–∫–æ–ª–æ–≥—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è</li></ul><p>–ï–∫—Å–ø–µ—Ä—Ç–∏ –æ—á—ñ–∫—É—é—Ç—å —à–≤–∏–¥–∫–æ–≥–æ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Ü–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π.</p>",
                image: null,
                tags: ["—Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó", "—ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó"]
            }
        ];

        // Utility functions
        function showMessage(elementId, message, isError = false) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="${isError ? 'error-message' : 'success-message'}">${message}</div>`;
            setTimeout(() => {
                element.innerHTML = '';
            }, 5000);
        }

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function togglePassword(inputId, eyeElement) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                // –Ü–∫–æ–Ω–∫–∞ –∑–∞–∫—Ä–∏—Ç–æ–≥–æ –æ–∫–∞ (–ø–∞—Ä–æ–ª—å –≤–∏–¥–Ω–æ)
                eyeElement.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/>
                        <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 11 8 11 8a13.16 13.16 0 0 1-1.67 2.68"/>
                        <path d="M6.61 6.61A13.526 13.526 0 0 0 1 12s4 8 11 8a9.74 9.74 0 0 0 5-1.73"/>
                        <line x1="2" y1="2" x2="22" y2="22"/>
                    </svg>
                `;
            } else {
                input.type = 'password';
                // –Ü–∫–æ–Ω–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ –æ–∫–∞ (–ø–∞—Ä–æ–ª—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π)
                eyeElement.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                `;
            }
        }

        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è EmailJS - –ó–ê–ú–Ü–ù–Ü–¢–¨ –ù–ê –í–ê–®–Ü –ö–õ–Æ–ß–Ü!
        const EMAIL_CONFIG = {
            publicKey: 'YOUR_EMAILJS_PUBLIC_KEY',      // –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à Public Key
            serviceId: 'YOUR_EMAILJS_SERVICE_ID',      // –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à Service ID  
            templateId: 'YOUR_EMAILJS_TEMPLATE_ID'     // –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à Template ID
        };

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è EmailJS
        function initEmailJS() {
            if (typeof emailjs !== 'undefined' && EMAIL_CONFIG.publicKey !== 'YOUR_EMAILJS_PUBLIC_KEY') {
                emailjs.init(EMAIL_CONFIG.publicKey);
                console.log('EmailJS —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ');
                return true;
            }
            console.log('EmailJS –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –∞–±–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π');
            return false;
        }

        async function sendEmailNotification(email, type, username) {
            const subject = type === 'register' ? '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –≤ –Ω–æ–≤–∏–Ω–Ω–æ–º—É –±–ª–æ–∑—ñ' : '–í—Ö—ñ–¥ –≤ –Ω–æ–≤–∏–Ω–Ω–∏–π –±–ª–æ–≥';
            const message = type === 'register' 
                ? `–í—ñ—Ç–∞—î–º–æ! –í–∏ —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–ª–∏—Å—è –≤ –Ω–æ–≤–∏–Ω–Ω–æ–º—É –±–ª–æ–∑—ñ –∑ –ª–æ–≥—ñ–Ω–æ–º: ${username}. –í–∞—à –∞–∫–∞—É–Ω—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ ${new Date().toLocaleString('uk-UA')}.`
                : `–í–∏ —É–≤—ñ–π—à–ª–∏ –≤ –Ω–æ–≤–∏–Ω–Ω–∏–π –±–ª–æ–≥ –∑ –ª–æ–≥—ñ–Ω–æ–º: ${username} –æ ${new Date().toLocaleString('uk-UA')}. –Ø–∫—â–æ —Ü–µ –±—É–ª–∏ –Ω–µ –≤–∏, –Ω–µ–≥–∞–π–Ω–æ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.`;
            
            // –°–ø—Ä–æ–±—É—î–º–æ EmailJS —Å–ø–æ—á–∞—Ç–∫—É
            if (initEmailJS()) {
                try {
                    console.log(`–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ email —á–µ—Ä–µ–∑ EmailJS –Ω–∞ ${email}...`);
                    
                    const templateParams = {
                        to_email: email,
                        subject: subject,
                        message: message,
                        username: username,
                        timestamp: new Date().toLocaleString('uk-UA')
                    };

                    const result = await emailjs.send(
                        EMAIL_CONFIG.serviceId,
                        EMAIL_CONFIG.templateId,
                        templateParams
                    );

                    console.log('Email —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ EmailJS:', result);
                    return { success: true, method: 'EmailJS', result };

                } catch (error) {
                    console.error('–ü–æ–º–∏–ª–∫–∞ EmailJS:', error);
                    // –ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ –∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
                }
            }

            // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 1: Poe API (—è–∫—â–æ EmailJS –Ω–µ –ø—Ä–∞—Ü—é—î)
            if (typeof window.Poe !== 'undefined' && typeof window.Poe.sendUserMessage === 'function') {
                try {
                    console.log(`–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ email —á–µ—Ä–µ–∑ Poe API –Ω–∞ ${email}...`);
                    
                    const result = await window.Poe.sendUserMessage(
                        `@Claude-Sonnet-4 –ù–∞–¥—ñ—à–ª–∏ email –Ω–∞ –∞–¥—Ä–µ—Å—É ${email}. –¢–µ–º–∞: "${subject}". –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "${message}". –ü—ñ–¥–ø–∏—Å: "–ó –ø–æ–≤–∞–≥–æ—é, –∫–æ–º–∞–Ω–¥–∞ –Ω–æ–≤–∏–Ω–Ω–æ–≥–æ –±–ª–æ–≥—É".`,
                        {
                            openChat: false,
                            stream: false
                        }
                    );
                    
                    console.log('Email –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ Poe API');
                    return { success: true, method: 'Poe API', result };
                    
                } catch (error) {
                    console.error('–ü–æ–º–∏–ª–∫–∞ Poe API:', error);
                }
            }

            // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 2: Webhook —Å–µ—Ä–≤—ñ—Å (–¥–æ–¥–∞–π—Ç–µ –≤–∞—à webhook URL)
            try {
                const webhookUrl = 'YOUR_WEBHOOK_URL'; // –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à webhook
                
                if (webhookUrl !== 'YOUR_WEBHOOK_URL') {
                    console.log(`–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ email —á–µ—Ä–µ–∑ Webhook –Ω–∞ ${email}...`);
                    
                    const response = await fetch(webhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            to: email,
                            subject: subject,
                            message: message,
                            username: username
                        })
                    });

                    if (response.ok) {
                        console.log('Email –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ Webhook');
                        return { success: true, method: 'Webhook' };
                    }
                }
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ Webhook:', error);
            }

            // –Ø–∫—â–æ –≤—Å—ñ –º–µ—Ç–æ–¥–∏ –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞–ª–∏ - –ª–æ–≥—É—î–º–æ –≤ –∫–æ–Ω—Å–æ–ª—å
            console.log('=== EMAIL –°–ü–û–í–Ü–©–ï–ù–ù–Ø (–†–ï–ó–ï–†–í–ù–ò–ô –†–ï–ñ–ò–ú) ===');
            console.log(`–ö–æ–º—É: ${email}`);
            console.log(`–¢–µ–º–∞: ${subject}`);
            console.log(`–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: ${message}`);
            console.log('==========================================');
            
            return { success: false, method: 'console', reason: '–í—Å—ñ email —Å–µ—Ä–≤—ñ—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ' };
        }

        function removeCurrentImage() {
            document.getElementById('currentImageContainer').classList.add('hidden');
            document.getElementById('currentImage').src = '';
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ñ–ª–∞–≥ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
            document.getElementById('newsImage').dataset.removeImage = 'true';
        }

        // Navigation functions
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Show selected page
            document.getElementById(pageName + 'Page').classList.remove('hidden');
            currentPage = pageName;
            
            // Update navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-black', 'text-white');
                btn.classList.add('text-black');
            });
            
            // Clear messages when switching pages
            ['loginMessage', 'registerMessage'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.innerHTML = '';
            });
            
            // Load page-specific content
            switch(pageName) {
                case 'home':
                    renderNewsList();
                    renderTagsFilter();
                    break;
                case 'admin':
                    if (currentUser && currentUser.role === 'admin') {
                        renderAdminNewsList();
                    } else {
                        showMessage('loginMessage', '–î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ. –ü–æ—Ç—Ä—ñ–±–Ω—ñ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.', true);
                        showPage('login');
                    }
                    break;
            }
        }

        // Authentication
        function register(event) {
            event.preventDefault();
            
            const name = document.getElementById('registerName').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const username = document.getElementById('registerUsername').value.trim();
            const password = document.getElementById('registerPassword').value;
            const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
            
            // Validation
            if (name.length < 2) {
                showMessage('registerMessage', '–Ü–º\'—è –ø–æ–≤–∏–Ω–Ω–æ –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ 2 —Å–∏–º–≤–æ–ª–∏', true);
                return;
            }
            
            if (!validateEmail(email)) {
                showMessage('registerMessage', '–í–≤–µ–¥—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π email', true);
                return;
            }
            
            if (username.length < 3) {
                showMessage('registerMessage', '–õ–æ–≥—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ 3 —Å–∏–º–≤–æ–ª–∏', true);
                return;
            }
            
            if (password.length < 6) {
                showMessage('registerMessage', '–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ 6 —Å–∏–º–≤–æ–ª—ñ–≤', true);
                return;
            }
            
            if (password !== passwordConfirm) {
                showMessage('registerMessage', '–ü–∞—Ä–æ–ª—ñ –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å', true);
                return;
            }
            
            // Check if username or email already exists
            if (users.find(user => user.username === username)) {
                showMessage('registerMessage', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–∏–º –ª–æ–≥—ñ–Ω–æ–º –≤–∂–µ —ñ—Å–Ω—É—î', true);
                return;
            }
            
            if (users.find(user => user.email === email)) {
                showMessage('registerMessage', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–∏–º email –≤–∂–µ —ñ—Å–Ω—É—î', true);
                return;
            }
            
            // Create new user
            const newUser = {
                id: Math.max(...users.map(u => u.id)) + 1,
                name,
                email,
                username,
                password,
                role: 'user'
            };
            
            users.push(newUser);
            
            // Send email notification
            showMessage('registerMessage', '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –Ω–∞ –≤–∞—à—É –ø–æ—à—Ç—É...', false);
            
            sendEmailNotification(email, 'register', username).then(emailResult => {
                if (emailResult.success) {
                    showMessage('registerMessage', '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! Email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∞—Ç –∑ Claude –∞–±–æ –≤–∞—à—É –ø–æ—à—Ç—É. –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ —É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.', false);
                } else {
                    showMessage('registerMessage', `–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! –ü—Ä–æ—Ç–µ email –Ω–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ (${emailResult.reason || emailResult.error}). –í–∏ –≤—Å–µ –æ–¥–Ω–æ –º–æ–∂–µ—Ç–µ —É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.`, false);
                }
            });
            
            // Clear form
            document.getElementById('registerName').value = '';
            document.getElementById('registerEmail').value = '';
            document.getElementById('registerUsername').value = '';
            document.getElementById('registerPassword').value = '';
            document.getElementById('registerPasswordConfirm').value = '';
            
            // Redirect to login after a delay
            setTimeout(() => {
                showPage('login');
            }, 3000);
        }

        function login(event) {
            event.preventDefault();
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            // Find user
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                
                // Update navigation first
                document.getElementById('loginBtn').classList.add('hidden');
                document.getElementById('registerBtn').classList.add('hidden');
                document.getElementById('userGreeting').classList.remove('hidden');
                document.getElementById('userGreeting').textContent = `–í—ñ—Ç–∞—î–º–æ, ${user.name}!`;
                document.getElementById('logoutBtn').classList.remove('hidden');
                
                if (user.role === 'admin') {
                    document.getElementById('adminBtn').classList.remove('hidden');
                    showPage('admin');
                } else {
                    showPage('home');
                }
                
                // Clear form
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                
                // Send email notification
                showMessage('loginMessage', '–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥! –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –Ω–∞ –≤–∞—à—É –ø–æ—à—Ç—É...', false);
                
                sendEmailNotification(user.email, 'login', username).then(emailResult => {
                    if (emailResult.success) {
                        console.log('Email —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ Claude. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∞—Ç –∞–±–æ –≤–∞—à—É –ø–æ—à—Ç—É.');
                    } else {
                        console.log(`Email –Ω–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏: ${emailResult.reason || emailResult.error}`);
                    }
                });
            } else {
                showMessage('loginMessage', '–ù–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω –∞–±–æ –ø–∞—Ä–æ–ª—å', true);
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginBtn').classList.remove('hidden');
            document.getElementById('registerBtn').classList.remove('hidden');
            document.getElementById('adminBtn').classList.add('hidden');
            document.getElementById('userGreeting').classList.add('hidden');
            document.getElementById('logoutBtn').classList.add('hidden');
            showPage('home');
        }

        // News rendering
        function renderNewsList() {
            const container = document.getElementById('newsList');
            let filteredNews = newsData;
            
            if (currentFilter) {
                filteredNews = newsData.filter(news => 
                    news.tags.includes(currentFilter)
                );
            }
            
            container.innerHTML = filteredNews.map(news => `
                <div class="bg-white border border-black rounded-lg shadow-md overflow-hidden">
                    ${news.image ? `<img src="${news.image}" alt="${news.title}" class="news-image">` : ''}
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2 text-black">${news.title}</h3>
                        <p class="text-black text-sm mb-2">
                            ${news.author} ‚Ä¢ ${news.date.toLocaleDateString('uk-UA')}
                        </p>
                        <div class="mb-3">
                            ${news.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                        <div class="text-black mb-4">
                            ${news.content.replace(/<[^>]*>/g, '').substring(0, 150)}...
                        </div>
                        <button onclick="showNewsDetail(${news.id})" class="text-black hover:underline">
                            –ß–∏—Ç–∞—Ç–∏ –¥–∞–ª—ñ ‚Üí
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderTagsFilter() {
            const container = document.getElementById('tagsFilter');
            const allTags = [...new Set(newsData.flatMap(news => news.tags))];
            
            container.innerHTML = `
                <button onclick="filterByTag(null)" class="tag-filter-btn bg-white border px-3 py-1 rounded text-sm text-black ${!currentFilter ? 'border-4 border-black font-bold' : 'border-black'}">–í—Å—ñ</button>
                ${allTags.map(tag => `
                    <button onclick="filterByTag('${tag}')" class="tag-filter-btn bg-white border px-3 py-1 rounded text-sm text-black ${currentFilter === tag ? 'border-4 border-black font-bold' : 'border-black'}">${tag}</button>
                `).join('')}
            `;
        }

        function filterByTag(tag) {
            currentFilter = tag;
            renderNewsList();
            renderTagsFilter();
        }

        function showNewsDetail(id) {
            const news = newsData.find(n => n.id === id);
            if (!news) return;
            
            document.getElementById('newsDetail').innerHTML = `
                <article class="bg-white border border-black rounded-lg shadow-md p-6">
                    ${news.image ? `<img src="${news.image}" alt="${news.title}" class="w-full h-64 object-cover rounded-lg mb-6">` : ''}
                    <h1 class="text-3xl font-bold mb-4 text-black">${news.title}</h1>
                    <div class="text-black mb-4">
                        <p>${news.author} ‚Ä¢ ${news.date.toLocaleDateString('uk-UA')}</p>
                        <div class="mt-2">
                            ${news.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                    <div class="prose max-w-none text-black">
                        ${news.content}
                    </div>
                </article>
            `;
            
            showPage('newsDetail');
        }

        // Admin functions
        function renderAdminNewsList() {
            const container = document.getElementById('adminNewsList');
            container.innerHTML = newsData.map(news => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-black">${news.title}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-black">${news.author}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-black">${news.date.toLocaleDateString('uk-UA')}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        <button onclick="editNews(${news.id})" class="text-black hover:underline mr-4">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                        <button onclick="deleteNews(${news.id})" class="text-red-600 hover:underline">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </td>
                </tr>
            `).join('');
        }

        function showAddForm() {
            editingNewsId = null;
            document.getElementById('formTitle').textContent = '–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–Ω—É';
            document.getElementById('newsTitle').value = '';
            document.getElementById('newsAuthor').value = '';
            document.getElementById('newsTags').value = '';
            document.getElementById('newsContent').innerHTML = '';
            document.getElementById('newsImage').value = '';
            document.getElementById('newsImage').dataset.removeImage = '';
            document.getElementById('currentImageContainer').classList.add('hidden');
            showPage('newsForm');
        }

        function editNews(id) {
            const news = newsData.find(n => n.id === id);
            if (!news) return;
            
            editingNewsId = id;
            document.getElementById('formTitle').textContent = '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–Ω—É';
            document.getElementById('newsId').value = news.id;
            document.getElementById('newsTitle').value = news.title;
            document.getElementById('newsAuthor').value = news.author;
            document.getElementById('newsTags').value = news.tags.join(', ');
            document.getElementById('newsContent').innerHTML = news.content;
            document.getElementById('newsImage').dataset.removeImage = '';
            
            if (news.image) {
                document.getElementById('currentImage').src = news.image;
                document.getElementById('currentImageContainer').classList.remove('hidden');
            } else {
                document.getElementById('currentImageContainer').classList.add('hidden');
            }
            
            showPage('newsForm');
        }

        function deleteNews(id) {
            if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –Ω–æ–≤–∏–Ω—É?')) {
                newsData = newsData.filter(n => n.id !== id);
                renderAdminNewsList();
                renderNewsList();
            }
        }

        function saveNews(event) {
            event.preventDefault();
            
            const title = document.getElementById('newsTitle').value;
            const author = document.getElementById('newsAuthor').value;
            const tags = document.getElementById('newsTags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
            const content = document.getElementById('newsContent').innerHTML;
            const imageFile = document.getElementById('newsImage').files[0];
            const removeImage = document.getElementById('newsImage').dataset.removeImage === 'true';
            
            const newsItem = {
                title,
                author,
                tags,
                content,
                date: new Date()
            };
            
            // Handle image upload
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newsItem.image = e.target.result;
                    saveNewsItem(newsItem);
                };
                reader.readAsDataURL(imageFile);
            } else {
                if (editingNewsId && !removeImage) {
                    const existingNews = newsData.find(n => n.id === editingNewsId);
                    newsItem.image = existingNews.image;
                } else {
                    newsItem.image = null;
                }
                saveNewsItem(newsItem);
            }
        }

        function saveNewsItem(newsItem) {
            if (editingNewsId) {
                // Update existing news
                const index = newsData.findIndex(n => n.id === editingNewsId);
                
                // –Ø–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ñ–ª–∞–≥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –≤–∏–¥–∞–ª—è—î–º–æ –π–æ–≥–æ
                if (document.getElementById('newsImage').dataset.removeImage === 'true') {
                    newsItem.image = null;
                }
                
                newsData[index] = { ...newsData[index], ...newsItem };
            } else {
                // Add new news
                newsItem.id = Math.max(...newsData.map(n => n.id)) + 1;
                newsData.push(newsItem);
            }
            
            showPage('admin');
        }

        // WYSIWYG editor functions
        function formatText(command, value = null) {
            document.execCommand(command, false, value);
            document.getElementById('newsContent').focus();
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ EmailJS –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
            initEmailJS();
            showPage('home');
        });

        // –Ø–∫—â–æ DOMContentLoaded –≤–∂–µ –ø—Ä–æ–π—à–æ–≤
        if (document.readyState === 'loading') {
            // –ß–µ–∫–∞—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        } else {
            // –î–æ–∫—É–º–µ–Ω—Ç –≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π
            initEmailJS();
            showPage('home');
        }
    </script>
</body>
</html>